<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Badillo">

<title>Ciencia de Datos con Python - Introducción a Estadística Bayesiana</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../neural_neworks/classes_python.html" rel="next">
<link href="../statistics/hipothesis_testing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Ciencia de Datos con Python - Introducción a Estadística Bayesiana">
<meta property="og:description" content="">
<meta property="og:site_name" content="Ciencia de Datos con Python">
<meta property="og:locale" content="es_MX">
<meta name="twitter:title" content="Ciencia de Datos con Python - Introducción a Estadística Bayesiana">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../statistics/data_manipulation.html">Manejo de Datos y Estadística con Python</a></li><li class="breadcrumb-item"><a href="../statistics/bayesian_statistics.html">Introducción a Estadística Bayesiana</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/logo-members/Lab25_logo_2015.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Ciencia de Datos con Python</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales">
            Source Code
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inicio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acerca</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Fundamentos de Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_python/Cloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instalación de Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_python/Variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Declaración de Variables y Operaciones</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_python/functions_and_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Funciones y Bucles de Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro_python/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estructuras de Datos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Manejo de Datos y Estadística con Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/data_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manipulación de datos con Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualización de datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/Linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelos Lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/hipothesis_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prueba de Hipótesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/bayesian_statistics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introducción a Estadística Bayesiana</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Redes Neuronales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../neural_neworks/classes_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programación Orientada a Objetos en Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../neural_neworks/neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a Redes Neuronales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../neural_neworks/ann_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Redes Neuronales Artificiales en Python</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de Contenido</h2>
   
  <ul>
  <li><a href="#estimación-de-un-parámetro" id="toc-estimación-de-un-parámetro" class="nav-link active" data-scroll-target="#estimación-de-un-parámetro">Estimación de un Parámetro</a>
  <ul class="collapse">
  <li><a href="#paso-1-definir-el-modelo-de-los-datos" id="toc-paso-1-definir-el-modelo-de-los-datos" class="nav-link" data-scroll-target="#paso-1-definir-el-modelo-de-los-datos">Paso 1: Definir el Modelo de los Datos</a></li>
  </ul></li>
  <li><a href="#paso-2-definir-la-distribución-de-probabilidad-a-priori" id="toc-paso-2-definir-la-distribución-de-probabilidad-a-priori" class="nav-link" data-scroll-target="#paso-2-definir-la-distribución-de-probabilidad-a-priori">Paso 2: Definir la Distribución de Probabilidad a Priori</a></li>
  <li><a href="#paso-3-calcular-la-distribución-de-probabilidad-a-posteriori" id="toc-paso-3-calcular-la-distribución-de-probabilidad-a-posteriori" class="nav-link" data-scroll-target="#paso-3-calcular-la-distribución-de-probabilidad-a-posteriori">Paso 3: Calcular la Distribución de Probabilidad a Posteriori</a></li>
  <li><a href="#paso-4-resumir-la-distribución-de-probabilidad-a-posteriori" id="toc-paso-4-resumir-la-distribución-de-probabilidad-a-posteriori" class="nav-link" data-scroll-target="#paso-4-resumir-la-distribución-de-probabilidad-a-posteriori">Paso 4: Resumir la Distribución de Probabilidad a Posteriori</a></li>
  <li><a href="#algoritmos-mcmc" id="toc-algoritmos-mcmc" class="nav-link" data-scroll-target="#algoritmos-mcmc">Algoritmos MCMC</a>
  <ul class="collapse">
  <li><a href="#cadenas-de-markov" id="toc-cadenas-de-markov" class="nav-link" data-scroll-target="#cadenas-de-markov">Cadenas de Markov</a></li>
  <li><a href="#monte-carlo" id="toc-monte-carlo" class="nav-link" data-scroll-target="#monte-carlo">Monte Carlo</a></li>
  <li><a href="#algoritmo-hastings-metropolis" id="toc-algoritmo-hastings-metropolis" class="nav-link" data-scroll-target="#algoritmo-hastings-metropolis">Algoritmo Hastings-Metropolis</a></li>
  </ul></li>
  <li><a href="#software-para-estadística-bayesiana" id="toc-software-para-estadística-bayesiana" class="nav-link" data-scroll-target="#software-para-estadística-bayesiana">Software para Estadística Bayesiana</a>
  <ul class="collapse">
  <li><a href="#stan" id="toc-stan" class="nav-link" data-scroll-target="#stan">Stan</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales/edit/main/statistics/bayesian_statistics.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../statistics/data_manipulation.html">Manejo de Datos y Estadística con Python</a></li><li class="breadcrumb-item"><a href="../statistics/bayesian_statistics.html">Introducción a Estadística Bayesiana</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introducción a Estadística Bayesiana</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Ver código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales/blob/main/statistics/bayesian_statistics.qmd">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Badillo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">26 de junio de 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Existen dos enfoques principales en estadística: el enfoque frecuentista y el enfoque bayesiano. En este documento, se presentará una introducción a la estadística bayesiana.</p>
<p>La filosofía de la estadística bayesiana es diferente a la de la estadística frecuentista. En la estadística bayesiana, se considera que la incertidumbre en los parámetros de un modelo se puede representar mediante una distribución de probabilidad. Por otro lado, en la estadística frecuentista, los parámetros son considerados como valores fijos y la incertidumbre se representa mediante intervalos de confianza, que son estimaciones de la variabilidad de los parámetros dada la muestra.</p>
<p>En la estadística bayesiana, se considera que los parámetros de un modelo son variables aleatorias y se les asigna una <strong>distribución de probabilidad a priori</strong>. Esta distribución de probabilidad a priori representa el conocimiento previo que se tiene sobre los parámetros antes de observar los datos. Luego, se actualiza esta distribución de probabilidad a priori con los datos observados para obtener la <strong>distribución de probabilidad a posteriori</strong>, que representa el conocimiento actualizado sobre los parámetros después de observar los datos.</p>
<p>Para lograr esta actualización utilizamos el Teorema de Bayes, que establece la relación entre la distribución de probabilidad a priori y la distribución de probabilidad a posteriori. El Teorema de Bayes se define de la siguiente manera:</p>
<p><span class="math display">\[ P(\theta|X) = \frac{L(X|\theta)P(\theta)}{P(X)} \]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(P(\theta|X)\)</span> es la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span>.</li>
<li><span class="math inline">\(L(X|\theta)\)</span> es la función de verosimilitud, que representa la verosimilitud de observar los datos <span class="math inline">\(X\)</span> dado los parámetros <span class="math inline">\(\theta\)</span>.</li>
<li><span class="math inline">\(P(\theta)\)</span> es la distribución de probabilidad a priori de los parámetros <span class="math inline">\(\theta\)</span>.</li>
</ul>
<p>La distribución de probabilidad a posteriori se obtiene multiplicando la función de verosimilitud por la distribución de probabilidad a priori y normalizando el resultado. La distribución de probabilidad a posteriori es la distribución de probabilidad de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span> y se utiliza para realizar inferencias sobre los parámetros del modelo.</p>
<section id="estimación-de-un-parámetro" class="level2">
<h2 class="anchored" data-anchor-id="estimación-de-un-parámetro">Estimación de un Parámetro</h2>
<p>Supongamos que lanzamos una moneda varias veces para poder estimar si la moneda tiene truco o esta sesgada. Para poder estimar este parámetro, podemos utilizar la estadística bayesiana. Para ello deberemos seguir los siguientes pasos:</p>
<section id="paso-1-definir-el-modelo-de-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="paso-1-definir-el-modelo-de-los-datos">Paso 1: Definir el Modelo de los Datos</h3>
<p>Lo primero es encontrar un modelo que describa los datos o en otros términos, encontrar una distribución de probabilidad que describa la probabilidad de obtener una cara o una cruz. En este caso, podemos utilizar una distribución de Bernoulli para modelar la probabilidad de obtener una cara o una cruz en un lanzamiento de moneda. La distribución de Bernoulli se define de la siguiente manera:</p>
<p><span class="math display">\[ L(X|\theta) = \theta^x(1-\theta)^{1-x} \]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(X\)</span> es la variable aleatoria que representa el resultado del lanzamiento de la moneda (0 si es cruz y 1 si es cara).</li>
<li><span class="math inline">\(\theta\)</span> es el parámetro de la distribución de Bernoulli que representa la probabilidad de obtener una cara en un lanzamiento de moneda.</li>
</ul>
<p>El problema es que solo sirve para un lanzamiento en particular y nuestros datos son el resultado de varios lanzamientos. Para poder modelar los datos de varios lanzamientos, podemos utilizar una distribución de Bernoulli generalizada, que se conoce como distribución de Binomial. La distribución de Binomial se define de la siguiente manera:</p>
<p><span class="math display">\[ L(X|\theta) = \binom{n}{x}\theta^x(1-\theta)^{n-x} \]</span></p>
<p>Donde <span class="math inline">\(n\)</span> es el número de lanzamientos de la moneda y <span class="math inline">\(x\)</span> es el número de caras obtenidas en los <span class="math inline">\(n\)</span> lanzamientos. Esta distribución representa la probabilidad de obtener <span class="math inline">\(x\)</span> caras en <span class="math inline">\(n\)</span> lanzamientos de una moneda con probabilidad <span class="math inline">\(\theta\)</span> de obtener una cara, <strong><em>pero aquí <span class="math inline">\(\theta\)</span> es una variable desconocida que queremos estimar y por tanto no representa una distribución de probabilidad</em></strong>. Será nuestro modelo de los datos o lo que llamamos anteriormente como la <strong>función de verosimilitud</strong>.</p>
<p>Vamos a simular datos de un lanzamiento de moneda con <span class="math inline">\(\theta = 0.65\)</span> y <span class="math inline">\(n = 40\)</span>.</p>
<div id="3c28e263" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>np.random.seed(<span class="dv">101408</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>datos <span class="op">=</span> np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], size<span class="op">=</span><span class="dv">40</span>, p<span class="op">=</span>[<span class="fl">0.35</span>, <span class="fl">0.65</span>])</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>plt.bar([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">0</span>), <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>)], color<span class="op">=</span>[<span class="st">'red'</span>, <span class="st">'blue'</span>])</span>
<span id="cb1-8"><a href="#cb1-8"></a>plt.xticks([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="st">'Cruz'</span>, <span class="st">'Cara'</span>], fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>plt.ylabel(<span class="st">'Frecuencia'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>plt.title(<span class="st">'Resultados de 40 lanzamientos de moneda'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-2-output-1.png" width="587" height="436" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora vamos a ver como luce la función de verosimilitud para distintos valores de <span class="math inline">\(\theta\)</span>.</p>
<div id="2579906b" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>plt.plot(theta, binom.pmf(<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>), <span class="dv">40</span>, theta), color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>plt.xlabel(<span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>plt.ylabel(<span class="vs">r'$L(X|\theta)$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>plt.title(<span class="st">'Función de Verosimilitud'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb2-9"><a href="#cb2-9"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-3-output-1.png" width="607" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="paso-2-definir-la-distribución-de-probabilidad-a-priori" class="level2">
<h2 class="anchored" data-anchor-id="paso-2-definir-la-distribución-de-probabilidad-a-priori">Paso 2: Definir la Distribución de Probabilidad a Priori</h2>
<p>El siguiente paso es definir una distribución de probabilidad a priori para el parámetro <span class="math inline">\(\theta\)</span>. La distribución de probabilidad a priori representa el conocimiento previo que se tiene sobre el parámetro <span class="math inline">\(\theta\)</span> antes de observar los datos.</p>
<p>Existen dos tipos de distribuciones de probabilidad a priori: distribuciones de probabilidad a priori <strong>informativas</strong> y distribuciones de probabilidad a priori <strong>no informativas</strong>. Las distribuciones de probabilidad a priori informativas se utilizan cuando se tiene información previa sobre el parámetro <span class="math inline">\(\theta\)</span> y se desea incorporar esta información en el análisis. Por otro lado, las distribuciones de probabilidad a priori no informativas se utilizan cuando no se tiene información previa sobre el parámetro <span class="math inline">\(\theta\)</span> y se desea dejar que los datos guíen la inferencia.</p>
<p>Debemos de pensar primeramente para que rangos nuestro parámetro <span class="math inline">\(\theta\)</span> puede variar. En este caso, como <span class="math inline">\(\theta\)</span> es una probabilidad, debe de estar en el rango <span class="math inline">\([0, 1]\)</span>. Una distribución de probabilidad a priori común para el parámetro <span class="math inline">\(\theta\)</span> es la distribución Beta, que se define de la siguiente manera:</p>
<p><span class="math display">\[ P(\theta) = \frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)} \]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> son los parámetros de la distribución Beta.</li>
<li><span class="math inline">\(B(\alpha, \beta)\)</span> es la función Beta, que es una constante de normalización.</li>
</ul>
<p>La función Beta se ve de la siguiente manera:</p>
<p><span class="math display">\[ B(\alpha, \beta) = \int_0^1 \theta^{\alpha-1}(1-\theta)^{\beta-1}d\theta \]</span></p>
<p>Veamos como se ve para distintos valores de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</p>
<div id="45d7ee75" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>theta <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="fl">0.99</span>, <span class="dv">1000</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>alphas <span class="op">=</span> [<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb3-5"><a href="#cb3-5"></a>betas <span class="op">=</span> [<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="cf">for</span> a <span class="kw">in</span> alphas:</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="cf">for</span> b <span class="kw">in</span> betas:</span>
<span id="cb3-11"><a href="#cb3-11"></a>        plt.plot(theta, beta.pdf(theta, a, b), label<span class="op">=</span><span class="ss">f'$</span><span class="ch">\\</span><span class="ss">alpha=</span><span class="sc">{</span>a<span class="sc">}</span><span class="ss">, </span><span class="ch">\\</span><span class="ss">beta=</span><span class="sc">{</span>b<span class="sc">}</span><span class="ss">$'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a>plt.xlabel(<span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a>plt.ylabel(<span class="vs">r'$P(\theta)$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-15"><a href="#cb3-15"></a>plt.title(<span class="st">'Distribución de Probabilidad a Priori'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>plt.legend()</span>
<span id="cb3-17"><a href="#cb3-17"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-4-output-1.png" width="806" height="539" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Las formas de la distribución de probabilidad a priori dependen de los valores de los parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Por ejemplo, si <span class="math inline">\(\alpha = \beta = 1\)</span>, la distribución de probabilidad a priori es uniforme en el intervalo <span class="math inline">\([0, 1]\)</span>. Si <span class="math inline">\(\alpha = \beta = 0.5\)</span>, la distribución de probabilidad a priori es una distribución de probabilidad a priori no informativa. Si <span class="math inline">\(\alpha &gt; \beta\)</span>, la distribución de probabilidad a priori se concentra en valores cercanos a 1. Si <span class="math inline">\(\alpha &lt; \beta\)</span>, la distribución de probabilidad a priori se concentra en valores cercanos a 0.</p>
<p>Usemos valores de <span class="math inline">\(\alpha = 1\)</span> y <span class="math inline">\(\beta = 1\)</span> para nuestra distribución de probabilidad a priori.</p>
</section>
<section id="paso-3-calcular-la-distribución-de-probabilidad-a-posteriori" class="level2">
<h2 class="anchored" data-anchor-id="paso-3-calcular-la-distribución-de-probabilidad-a-posteriori">Paso 3: Calcular la Distribución de Probabilidad a Posteriori</h2>
<p>El siguiente paso es calcular la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span>. Para ello, utilizamos el Teorema de Bayes.</p>
<p><span class="math display">\[\begin{equation}
P(\theta|X) = \frac{L(X|\theta)P(\theta)}{P(X)} = \frac{L(X|\theta)P(\theta)}{\int L(X|\theta)P(\theta)d\theta}
\end{equation}\]</span></p>
<p>Vamos a reemplazar la función de verosimilitud y la distribución de probabilidad a priori en la ecuación anterior.</p>
<p><span class="math display">\[\begin{align}
P(\theta|X) &amp; = \frac{\binom{n}{x}\theta^x(1-\theta)^{n-x}\frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)}}{\int \binom{n}{x}\theta^x(1-\theta)^{n-x}\frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)}d\theta} \\
&amp; = \frac{\theta^{x+\alpha-1}(1-\theta)^{n-x+\beta-1}}{\int \theta^{x+\alpha-1}(1-\theta)^{n-x+\beta-1}d\theta}
\end{align}\]</span></p>
<p>Si recordamos la forma de la distribución Beta podemos ver que son muy similares y de hecho la distribución de probabilidad a posteriori es una distribución Beta con parámetros <span class="math inline">\(\alpha' = x+\alpha\)</span> y <span class="math inline">\(\beta' = n-x+\beta\)</span>. Bravo!!!! Ya tenemos nuestra distribución de probabilidad a posteriori y sin realizar ninguna integral complicada.</p>
<p><span class="math display">\[ P(\theta|X) = \frac{\theta^{x+\alpha-1}(1-\theta)^{n-x+\beta-1}}{B(x+\alpha, n-x+\beta)} \]</span></p>
<p><span class="math display">\[ P(\theta|X) \sim Beta(x+\alpha, n-x+\beta) \]</span></p>
<p>Vamos a calcular la distribución de probabilidad a posteriori para los datos simulados.</p>
<div id="20a033ed" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>alpha_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>beta_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>posterior <span class="op">=</span> beta.pdf(theta, <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> alpha_prior, <span class="dv">40</span> <span class="op">-</span> <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> beta_prior)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>plt.plot(theta, posterior, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>plt.xlabel(<span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>plt.ylabel(<span class="vs">r'$P(\theta|X)$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>plt.title(<span class="st">'Distribución de Probabilidad a Posteriori'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-5-output-1.png" width="633" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Juntemos todo en un solo gráfico.</p>
<div id="8781337d" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>plt.plot(theta, binom.pmf(<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>), <span class="dv">40</span>, theta), color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Verosimilitud'</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>plt.plot(theta, beta.pdf(theta, alpha_prior, beta_prior), color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Priori'</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>plt.plot(theta, posterior<span class="op">*</span><span class="fl">0.185</span>, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Posteriori'</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>plt.xlabel(<span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>plt.ylabel(<span class="vs">r'$P(\theta)$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>plt.title(<span class="st">'Distribuciones de Probabilidad'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>plt.legend()</span>
<span id="cb5-12"><a href="#cb5-12"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-6-output-1.png" width="819" height="539" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Solamente escalamos la distribución a posteriori por fines de visualización. La distribución de probabilidad a posteriori es una combinación de la distribución de probabilidad a priori y la función de verosimilitud. La distribución de probabilidad a posteriori se concentra en valores de <span class="math inline">\(\theta\)</span> que son consistentes con los datos observados y las creencias previas sobre el parámetro <span class="math inline">\(\theta\)</span>.</p>
<p>En este ejemplo hemos hecho uso de lo que se conocen como <strong>priors conjugados</strong>, que son aquellos que al multiplicar la función de verosimilitud por la distribución de probabilidad a priori, obtenemos una distribución de probabilidad a posteriori de la misma familia que la distribución de probabilidad a priori. En este caso, la distribución Beta es un prior conjugado para la distribución de Bernoulli o Binomial conocido como <strong><em>Modelo Beta-Binomial</em></strong>. Algunos priors conjugados son:</p>
<table class="table">
<thead>
<tr class="header">
<th>Distribución de Probabilidad</th>
<th>Prior Conjugado</th>
<th>Posterior Conjugado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bernoulli</td>
<td>Beta</td>
<td>Beta</td>
</tr>
<tr class="even">
<td>Binomial</td>
<td>Beta</td>
<td>Beta</td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>Gamma</td>
<td>Gamma</td>
</tr>
<tr class="even">
<td>Normal</td>
<td>Normal</td>
<td>Normal</td>
</tr>
</tbody>
</table>
</section>
<section id="paso-4-resumir-la-distribución-de-probabilidad-a-posteriori" class="level2">
<h2 class="anchored" data-anchor-id="paso-4-resumir-la-distribución-de-probabilidad-a-posteriori">Paso 4: Resumir la Distribución de Probabilidad a Posteriori</h2>
<p>Una vez que hemos calculado la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span>, podemos realizar inferencias sobre los parámetros del modelo. Por ejemplo, podemos calcular la media, la mediana, la moda y los intervalos de credibilidad de la distribución de probabilidad a posteriori.</p>
<div id="04cd1fc5" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>media_posterior <span class="op">=</span> beta.mean(<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> alpha_prior, <span class="dv">40</span> <span class="op">-</span> <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> beta_prior)</span>
<span id="cb6-4"><a href="#cb6-4"></a>mediana_posterior <span class="op">=</span> beta.median(<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> alpha_prior, <span class="dv">40</span> <span class="op">-</span> <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> beta_prior)</span>
<span id="cb6-5"><a href="#cb6-5"></a>moda_posterior <span class="op">=</span> (<span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> alpha_prior <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (<span class="dv">40</span> <span class="op">+</span> alpha_prior <span class="op">+</span> beta_prior <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>credibilidad_95 <span class="op">=</span> beta.interval(<span class="fl">0.95</span>, <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> alpha_prior, <span class="dv">40</span> <span class="op">-</span> <span class="bu">sum</span>(datos <span class="op">==</span> <span class="dv">1</span>) <span class="op">+</span> beta_prior)</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="bu">print</span>(<span class="ss">f'Media de la distribución de probabilidad a posteriori: </span><span class="sc">{</span>media_posterior<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="bu">print</span>(<span class="ss">f'Mediana de la distribución de probabilidad a posteriori: </span><span class="sc">{</span>mediana_posterior<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="bu">print</span>(<span class="ss">f'Moda de la distribución de probabilidad a posteriori: </span><span class="sc">{</span>moda_posterior<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="bu">print</span>(<span class="ss">f'Intervalo de credibilidad al 95%: </span><span class="sc">{</span>credibilidad_95<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Media de la distribución de probabilidad a posteriori: 0.64
Mediana de la distribución de probabilidad a posteriori: 0.65
Moda de la distribución de probabilidad a posteriori: 0.65
Intervalo de credibilidad al 95%: (0.49405252639426683, 0.7787721379389346)</code></pre>
</div>
</div>
<p>Gráfiquemos la distribución de probabilidad a posteriori con la media y los intervalos de credibilidad.</p>
<div id="ef78134a" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>plt.plot(theta, posterior, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>plt.axvline(media_posterior, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Media'</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>plt.fill_between(theta, <span class="dv">0</span>, posterior, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                where<span class="op">=</span>(theta <span class="op">&gt;=</span> credibilidad_95[<span class="dv">0</span>]) <span class="op">&amp;</span> (theta <span class="op">&lt;=</span> credibilidad_95[<span class="dv">1</span>]), </span>
<span id="cb8-5"><a href="#cb8-5"></a>                color<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, </span>
<span id="cb8-6"><a href="#cb8-6"></a>                label<span class="op">=</span><span class="st">'Intervalo de Credibilidad al 95%'</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>plt.annotate(<span class="ss">f'Mean: </span><span class="sc">{</span>media_posterior<span class="sc">:.2f}</span><span class="ss">'</span>, (media_posterior, <span class="dv">0</span>), </span>
<span id="cb8-9"><a href="#cb8-9"></a>            textcoords<span class="op">=</span><span class="st">'offset points'</span>, xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), </span>
<span id="cb8-10"><a href="#cb8-10"></a>            ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>plt.xlabel(<span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>plt.ylabel(<span class="vs">r'$P(\theta|X)$'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>plt.title(<span class="st">'Distribución de Probabilidad a Posteriori'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a>plt.legend()</span>
<span id="cb8-17"><a href="#cb8-17"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-8-output-1.png" width="633" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Estos estadísticos son los que se reportan en la estadística bayesiana para resumir la distribución de probabilidad a posteriori y realizar inferencias sobre los parámetros del modelo. La media de la distribución de probabilidad a posteriori es un estimador puntual del parámetro <span class="math inline">\(\theta\)</span> y representa el valor esperado de <span class="math inline">\(\theta\)</span> dado los datos observados. La mediana de la distribución de probabilidad a posteriori es el valor que divide la distribución en dos partes iguales y representa el valor más probable de <span class="math inline">\(\theta\)</span> dado los datos observados. La moda de la distribución de probabilidad a posteriori es el valor que tiene la mayor densidad de probabilidad y representa el valor más probable de <span class="math inline">\(\theta\)</span> dado los datos observados. Los intervalos de credibilidad son intervalos que contienen un cierto porcentaje de la distribución de probabilidad a posteriori y representan la incertidumbre en la estimación de <span class="math inline">\(\theta\)</span> dado los datos observados.</p>
</section>
<section id="algoritmos-mcmc" class="level1">
<h1>Algoritmos MCMC</h1>
<p>En la práctica, calcular la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span> puede ser complicado, especialmente cuando el modelo es complejo y no se puede obtener una solución analítica. En estos casos, se utilizan algoritmos de muestreo de Markov Chain Monte Carlo (MCMC) para aproximar la distribución de probabilidad a posteriori.</p>
<p>Vamos a despedazar el nombre del algoritmo:</p>
<ul>
<li><strong>Markov Chain</strong>: Es un proceso estocástico en el que la probabilidad de pasar de un estado a otro depende solo del estado actual y no de los estados anteriores. En el contexto de MCMC, la cadena de Markov es una secuencia de muestras de los parámetros <span class="math inline">\(\theta\)</span> que se generan de acuerdo con la distribución de probabilidad a posteriori.</li>
<li><strong>Monte Carlo</strong>: Es un método de simulación que se utiliza para aproximar la distribución de probabilidad a posteriori mediante la generación de muestras aleatorias de los parámetros <span class="math inline">\(\theta\)</span>.</li>
</ul>
<section id="cadenas-de-markov" class="level3">
<h3 class="anchored" data-anchor-id="cadenas-de-markov">Cadenas de Markov</h3>
<p>Una cadena de Markov es una secuencia de variables aleatorias <span class="math inline">\(X_1, X_2, ..., X_n\)</span> que satisfacen la propiedad de Markov. La propiedad de Markov establece que la probabilidad de que la variable aleatoria <span class="math inline">\(X_{n+1}\)</span> tome un valor dado depende solo del valor actual de la variable aleatoria <span class="math inline">\(X_n\)</span> y no de los valores anteriores de la variable aleatoria <span class="math inline">\(X_1, X_2, ..., X_{n-1}\)</span>. En otras palabras, la probabilidad de transición de un estado a otro depende solo del estado actual y no de los estados anteriores.</p>
<p>Normalmente se representan las cadenas de Markov mediante una matriz de transición <span class="math inline">\(P\)</span>, que es una matriz cuadrada cuyas filas y columnas representan los estados de la cadena de Markov y cuyos elementos representan las probabilidades de transición de un estado a otro.</p>
<p>Veamos un ejemplo de una cadena de Markov con dos estados.</p>
<div id="eaac6870" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>np.random.seed(<span class="dv">101408</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Matriz de transición</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>P <span class="op">=</span> np.array([[<span class="fl">0.6</span>, <span class="fl">0.4</span>], [<span class="fl">0.3</span>, <span class="fl">0.7</span>]])</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># Estado inicial</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>estado <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Número de pasos</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Generar la cadena de Markov</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>cadena <span class="op">=</span> [estado]</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb9-18"><a href="#cb9-18"></a>    estado <span class="op">=</span> np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], p<span class="op">=</span>P[estado])</span>
<span id="cb9-19"><a href="#cb9-19"></a>    cadena.append(estado)</span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a>cadena</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="530">
<pre><code>[0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1]</code></pre>
</div>
</div>
<p>En este ejemplo, la cadena de Markov tiene dos estados (0 y 1) y la matriz de transición <span class="math inline">\(P\)</span> es una matriz de <span class="math inline">\(2 \times 2\)</span> cuyos elementos representan las probabilidades de transición de un estado a otro. El estado inicial de la cadena de Markov es 0 y se generan 10 pasos de la cadena de Markov. La cadena de Markov es una secuencia de estados que se generan de acuerdo con la matriz de transición <span class="math inline">\(P\)</span>.</p>
<p>Si multiplicamos <span class="math inline">\(n\)</span> veces la matriz de transición <span class="math inline">\(P\)</span> por el vector de estado inicial, obtendremos la distribución de probabilidad de los estados de la cadena de Markov después de <span class="math inline">\(n\)</span> pasos.</p>
<div id="3e946685" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>estado_inicial <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb11-4"><a href="#cb11-4"></a>    estado_inicial <span class="op">=</span> np.dot(estado_inicial, P)</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>estado_inicial</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="531">
<pre><code>array([0.4285748, 0.5714252])</code></pre>
</div>
</div>
<p>Aquí se imprime la probabilidad de estar en el estado 0 y en el estado 1 después de 10 pasos de la cadena de Markov. La probabilidad de estar en el estado 0 es 0.428 y la probabilidad de estar en el estado 1 es 0.572.</p>
<p>En el caso de los algorithmos MCMC, la matriz de transición <span class="math inline">\(P\)</span> es una matriz de transición de la cadena de Markov que se utiliza para generar muestras de los parámetros <span class="math inline">\(\theta\)</span> de acuerdo con el producto de la función de verosimilitud y la distribución de probabilidad a priori.</p>
</section>
<section id="monte-carlo" class="level3">
<h3 class="anchored" data-anchor-id="monte-carlo">Monte Carlo</h3>
<p>El método de Monte Carlo es un método de simulación que se utiliza para aproximar la distribución de probabilidad a posteriori mediante la generación de muestras aleatorias de los parámetros <span class="math inline">\(\theta\)</span>. El método de Monte Carlo se basa en el principio de que si se generan suficientes muestras aleatorias de los parámetros <span class="math inline">\(\theta\)</span> de acuerdo con la distribución de probabilidad a posteriori, se puede aproximar la distribución de probabilidad a posteriori y realizar inferencias sobre los parámetros del modelo.</p>
<p>Un ejemplo clásico de Monte Carlo es calcular el área de un círculo mediante la generación de puntos aleatorios dentro de un cuadrado que contiene el círculo y contando el número de puntos que caen dentro del círculo. La proporción de puntos que caen dentro del círculo con respecto al total de puntos generados es una aproximación del área del círculo.</p>
<div id="5e68ddc3" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>np.random.seed(<span class="dv">20011408</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>n <span class="op">=</span> <span class="dv">2500</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb13-8"><a href="#cb13-8"></a>y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="kw">def</span> dentro_circulo(x, y):</span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span> <span class="dv">1</span></span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb13-14"><a href="#cb13-14"></a>plt.scatter(x, y, c<span class="op">=</span>dentro_circulo(x, y), cmap<span class="op">=</span><span class="st">'coolwarm'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>plt.title(<span class="st">'Puntos Aleatorios en un Círculo'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-16"><a href="#cb13-16"></a>plt.axis(<span class="st">'equal'</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a>plt.show()</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a>area_circulo <span class="op">=</span> <span class="bu">sum</span>(dentro_circulo(x, y)) <span class="op">/</span> n <span class="op">*</span> <span class="dv">4</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>area_circulo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-11-output-1.png" width="530" height="514" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="532">
<pre><code>3.1328</code></pre>
</div>
</div>
<p>En este ejemplo, se generan 2500 puntos aleatorios dentro de un cuadrado que contiene un círculo de radio 1. Se cuentan el número de puntos que caen dentro del círculo y se calcula la proporción de puntos que caen dentro del círculo con respecto al total de puntos generados. La proporción de puntos que caen dentro del círculo es una aproximación del área del círculo y se multiplica por 4 para obtener el área del círculo.</p>
<p>Los métodos Monte Carlo siguen un patrón en la resolución de problemas:</p>
<ol type="1">
<li>Definir un conjunto posible de valores.</li>
<li>Generar valores aleatorios de acuerdo a una distribución de probabilidad.</li>
<li>Realizar un computo con los valores generados.</li>
<li>Repetir los pasos 2 y 3 un número suficiente de veces.</li>
</ol>
</section>
<section id="algoritmo-hastings-metropolis" class="level3">
<h3 class="anchored" data-anchor-id="algoritmo-hastings-metropolis">Algoritmo Hastings-Metropolis</h3>
<p>El algoritmo de Metropolis-Hastings es un algoritmo de muestreo de Markov Chain Monte Carlo (MCMC) que se utiliza para aproximar la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos <span class="math inline">\(X\)</span>. El algoritmo de Metropolis-Hastings se basa en la generación de muestras de los parámetros <span class="math inline">\(\theta\)</span> de acuerdo con la distribución de probabilidad a posteriori mediante la aceptación o rechazo de las muestras generadas.</p>
<p>Veamos como funciona este algoritmo con un ejemplo sencillo. Supongamos que somos politicos y queremos que la mayoria de personas voten por nosotros. Supongamos que hay 7 estados, nuestro objetivo es visitar cada uno dependiendo de la población de cada estado. La probabilidad de visitar cada estado es proporcional a la población de cada estado. Supongamos que la población de cada estado es la siguiente:</p>
<div id="07388f62" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>poblacion <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">700</span>])</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>proporcion <span class="op">=</span> poblacion <span class="op">/</span> <span class="bu">sum</span>(poblacion)</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>plt.bar(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">8</span>), proporcion, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>plt.xlabel(<span class="st">'Estado'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>plt.ylabel(<span class="st">'Proporción'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb15-11"><a href="#cb15-11"></a>plt.title(<span class="st">'Proporción de Población por Estado'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-12-output-1.png" width="614" height="466" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En este ejemplo, la población de cada estado es proporcional a la probabilidad de visitar cada estado. El objetivo es visitar cada estado de acuerdo con la proporción de la población de cada estado.</p>
<p>Definamos una regla para visitar cada estado. La regla es la siguiente:</p>
<ol type="1">
<li>Elegir el primer estado a visitar de forma aleatoria.</li>
<li>Pomos cambiarnos a cualquier estado aledaño.</li>
<li>Para saber a que estado aledaño cambiarnos lanzamos una moneda y si cae cara consideramos el estado aledaño, si cae cruz consideramos el otro estado.</li>
<li>Si la proporción de la población del estado considerado es mayor que la proporción de la población del estado actual, nos cambiamos al estado considerado. En caso contrario, giramos una ruleta y si cae en un número menor a la proporción de la población del estado considerado, nos cambiamos al estado considerado, sino nos quedamos en el estado actual.</li>
</ol>
<p>Veamos como se ve este algoritmo.</p>
<div id="2aa124c7" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>np.random.seed(<span class="dv">20011408</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>n <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>estados <span class="op">=</span> np.zeros(n, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>estados[<span class="dv">0</span>] <span class="op">=</span> np.random.choice(<span class="bu">range</span>(<span class="dv">7</span>))</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>hab_act <span class="op">=</span> poblacion[estados[<span class="dv">0</span>]]</span>
<span id="cb16-8"><a href="#cb16-8"></a>pos_act <span class="op">=</span> estados[<span class="dv">0</span>]</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb16-11"><a href="#cb16-11"></a>    next_pos <span class="op">=</span> pos_act <span class="op">+</span> np.random.choice([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], p<span class="op">=</span>[<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="cf">if</span> next_pos <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span> <span class="kw">and</span> next_pos <span class="op">&lt;</span> <span class="dv">7</span>:</span>
<span id="cb16-13"><a href="#cb16-13"></a>        hab_sig <span class="op">=</span> poblacion[next_pos]</span>
<span id="cb16-14"><a href="#cb16-14"></a>        <span class="cf">if</span> hab_sig <span class="op">&gt;</span> hab_act:</span>
<span id="cb16-15"><a href="#cb16-15"></a>            estados[i] <span class="op">=</span> next_pos</span>
<span id="cb16-16"><a href="#cb16-16"></a>            hab_act <span class="op">=</span> hab_sig</span>
<span id="cb16-17"><a href="#cb16-17"></a>            pos_act <span class="op">=</span> next_pos</span>
<span id="cb16-18"><a href="#cb16-18"></a>        <span class="cf">else</span>:</span>
<span id="cb16-19"><a href="#cb16-19"></a>            <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> hab_sig <span class="op">/</span> hab_act:</span>
<span id="cb16-20"><a href="#cb16-20"></a>                estados[i] <span class="op">=</span> next_pos</span>
<span id="cb16-21"><a href="#cb16-21"></a>                hab_act <span class="op">=</span> hab_sig</span>
<span id="cb16-22"><a href="#cb16-22"></a>                pos_act <span class="op">=</span> next_pos</span>
<span id="cb16-23"><a href="#cb16-23"></a>            <span class="cf">else</span>:</span>
<span id="cb16-24"><a href="#cb16-24"></a>                estados[i] <span class="op">=</span> pos_act</span>
<span id="cb16-25"><a href="#cb16-25"></a>    <span class="cf">else</span>:</span>
<span id="cb16-26"><a href="#cb16-26"></a>        estados[i] <span class="op">=</span> pos_act</span>
<span id="cb16-27"><a href="#cb16-27"></a></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co"># Plor estados en eje x y la iteración en el eje y</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb16-30"><a href="#cb16-30"></a>ax.plot(estados, color<span class="op">=</span><span class="st">'blue'</span>, ls<span class="op">=</span><span class="st">'-'</span>, lw<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-31"><a href="#cb16-31"></a></span>
<span id="cb16-32"><a href="#cb16-32"></a>plt.xlabel(<span class="st">'Iteración'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb16-33"><a href="#cb16-33"></a>plt.ylabel(<span class="st">'Estado'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb16-34"><a href="#cb16-34"></a>plt.title(<span class="st">'Cadena de Markov'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-35"><a href="#cb16-35"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-13-output-1.png" width="806" height="539" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Vamos a crear un histograma de la densidad de visitas por estado y la verdadera proporción de la población de cada estado.</p>
<div id="098d7661" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>plt.bar(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">7</span>), proporcion, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>plt.hist(estados, bins<span class="op">=</span><span class="dv">7</span>, color<span class="op">=</span><span class="st">'blue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>plt.xlabel(<span class="st">'Estado'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>plt.ylabel(<span class="st">'Densidad'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a>plt.title(<span class="st">'Frecuencia de Visitas por Estado'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-14-output-1.png" width="604" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como vemos la cadena de Markov se ajusta a la proporción de la población de cada estado. Este es un ejemplo sencillo de como funciona el algoritmo de Metropolis-Hastings.</p>
<p>En general lo que hace el algoritmo de Metropolis-Hasting es lo siguiente:</p>
<ol type="1">
<li>Inicializar el parámetro <span class="math inline">\(\theta\)</span> con un valor inicial.</li>
<li>Generar un valor propuesto <span class="math inline">\(\theta'\)</span> de acuerdo a una distribución de probabilidad de propuesta.</li>
<li>Calcular la razón de aceptación <span class="math inline">\(r = \frac{P(\theta'|X)}{P(\theta|X)}\)</span>.</li>
<li>Generar un número aleatorio <span class="math inline">\(u\)</span> de una distribución uniforme en el intervalo <span class="math inline">\([0, 1]\)</span>.</li>
<li>Si <span class="math inline">\(u &lt; r\)</span>, aceptar el valor propuesto <span class="math inline">\(\theta'\)</span> y actualizar el parámetro <span class="math inline">\(\theta\)</span> con el valor propuesto <span class="math inline">\(\theta'\)</span>.</li>
<li>Si <span class="math inline">\(u \geq r\)</span>, rechazar el valor propuesto <span class="math inline">\(\theta'\)</span> y mantener el parámetro <span class="math inline">\(\theta\)</span> con el valor actual.</li>
<li>Repetir los pasos 2-6 un número suficiente de veces para generar muestras de los parámetros <span class="math inline">\(\theta\)</span> de acuerdo con la distribución de probabilidad a posteriori.</li>
</ol>
<p>La <em>distribución propuesta</em> generalmente es una distribución normal con media en el valor actual del parámetro <span class="math inline">\(\theta\)</span> y una desviación estándar que se ajusta para que la proporción de aceptación sea cercana al 0.5, pero se prefiere el uso de distribuciones no simricas alrededor del valor actual del parámetro <span class="math inline">\(\theta\)</span>.</p>
<p>Para calcular la razón, se usa el producto de la función de verosimilitud, la distribución a priori y la probabilidad de la distribución propuesta. La probabilidad de la distribución propuesta se cancela en el cálculo de la razón de aceptación si es simétrica.</p>
<p><span class="math display">\[ r = \frac{P(X|\theta')P(\theta')}{P(X|\theta)P(\theta)} \]</span></p>
<p>Una implementación sencilla del algoritmo de Metropolis-Hastings se encuentra <a href="https://drive.google.com/file/d/1pL5qiH-Cn-TOzQQh5IO6pbZB-C3g4bcC/view?usp=sharing">aquí</a></p>
</section>
</section>
<section id="software-para-estadística-bayesiana" class="level1">
<h1>Software para Estadística Bayesiana</h1>
<p>Existen varios paquetes de software que se utilizan para realizar análisis estadísticos bayesianos que implementan algoritmos MCMC para aproximar la distribución de probabilidad a posteriori de los parámetros <span class="math inline">\(\theta\)</span> dado los datos $X. Algunos de los paquetes de software más populares para realizar análisis estadísticos bayesianos son:</p>
<ul>
<li><strong>Stan</strong></li>
<li><strong>PyMC3</strong></li>
<li><strong>JAGS</strong></li>
</ul>
<p>Estos paquetes de software proporcionan una interfaz de programación para especificar modelos estadísticos bayesianos y realizar inferencias sobre los parámetros del modelo utilizando algoritmos MCMC. Los paquetes de software también proporcionan herramientas para visualizar los resultados del análisis estadístico bayesiano y realizar diagnósticos de los algoritmos MCMC.</p>
<section id="stan" class="level2">
<h2 class="anchored" data-anchor-id="stan">Stan</h2>
<p>Stan es el lenguaje probabilístico más popular para realizar análisis estadísticos bayesianos, con el uso de algoritmos MCMC. Stan proporciona una interfaz de programación en C++, Python y R para especificar modelos estadísticos bayesianos y realizar inferencias sobre los parámetros del modelo.</p>
<p>Para usarlo en python, se puede instalar con el siguiente comando:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="ex">pip</span> install pystan</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pero solo funciona para sistemas operativos Unix (Linux, MacOS) y no para Windows. Se puede utilziar en google colab o en un servidor de jupyter notebook en un sistema operativo Unix.</p>
<p>Veamos como realizar una regresión lineal bayesiana con Stan.</p>
<div id="0f3fbdaf" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="im">import</span> stan</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a>np.random.seed(<span class="dv">20011408</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co"># Generar datos</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>n <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>x <span class="op">=</span> np.random.normal(<span class="dv">100</span>, <span class="dv">25</span>, n)</span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co"># Coeficientes</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>beta_0 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>beta_1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># Generar datos</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>y <span class="op">=</span> beta_0 <span class="op">+</span> beta_1 <span class="op">*</span> x <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">40</span>, n)</span>
<span id="cb19-17"><a href="#cb19-17"></a></span>
<span id="cb19-18"><a href="#cb19-18"></a>plt.scatter(x, y, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb19-19"><a href="#cb19-19"></a>plt.xlabel(<span class="st">'X'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-20"><a href="#cb19-20"></a>plt.ylabel(<span class="st">'Y'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb19-21"><a href="#cb19-21"></a>plt.title(<span class="st">'Datos simulados'</span>, fontsize<span class="op">=</span><span class="dv">20</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-22"><a href="#cb19-22"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-15-output-1.png" width="600" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Para poder usar Stan, se debe de escribir un archivo con extensión <code>.stan</code> con el siguiente contenido:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">data</span> {</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N;</span>
<span id="cb20-3"><a href="#cb20-3"></a>    <span class="dt">vector</span>[N] x;</span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="dt">vector</span>[N] y;</span>
<span id="cb20-5"><a href="#cb20-5"></a>}</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">parameters</span> {</span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="dt">real</span> beta_0;</span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="dt">real</span> beta_1;</span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb20-11"><a href="#cb20-11"></a>}</span>
<span id="cb20-12"><a href="#cb20-12"></a></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="kw">model</span> {</span>
<span id="cb20-14"><a href="#cb20-14"></a>    beta_0 ~ normal(<span class="dv">0</span>, <span class="dv">10</span>);</span>
<span id="cb20-15"><a href="#cb20-15"></a>    beta_1 ~ normal(<span class="dv">0</span>, <span class="dv">10</span>);</span>
<span id="cb20-16"><a href="#cb20-16"></a>    sigma ~ normal(<span class="dv">0</span>, <span class="dv">10</span>);</span>
<span id="cb20-17"><a href="#cb20-17"></a>    y ~ normal(beta_0 + beta_1 * x, sigma);</span>
<span id="cb20-18"><a href="#cb20-18"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Estos bloques se especifican de la siguiente manera:</p>
<ul>
<li><strong>data</strong>: Se especifican los datos que se utilizarán en el modelo. En este caso, se especifica el número de observaciones <code>N</code>, el vector de variables independientes <code>x</code> y el vector de variables dependientes <code>y</code>.</li>
<li><strong>parameters</strong>: Se especifican los parámetros del modelo que se estimarán. En este caso, se especifican los coeficientes <code>beta_0</code> y <code>beta_1</code> de la regresión lineal y la desviación estándar <code>sigma</code> del error.</li>
<li><strong>model</strong>: Se especifica el modelo estadístico que se utilizará para realizar inferencias sobre los parámetros del modelo. En este caso, se especifica que los datos <code>y</code> se distribuyen normalmente con media <code>beta_0 + beta_1 * x</code> y desviación estándar <code>sigma</code>.</li>
</ul>
<p>Ahora vamos a compilar el modelo y ajustarlo a los datos.</p>
<div id="98dc4f5e" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">import</span> nest_asyncio</span>
<span id="cb21-2"><a href="#cb21-2"></a>nest_asyncio.<span class="bu">apply</span>()</span>
<span id="cb21-3"><a href="#cb21-3"></a>model <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">data {</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="st">    int&lt;lower=0&gt; N;</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="st">    vector[N] x;</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="st">    vector[N] y;</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="st">}</span></span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="st">parameters {</span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="st">    real beta_0;</span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="st">    real beta_1;</span></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="st">    real&lt;lower=0&gt; sigma;</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="st">}</span></span>
<span id="cb21-15"><a href="#cb21-15"></a></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="st">model {</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="st">    beta_0 ~ normal(0, 10);</span></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="st">    beta_1 ~ normal(0, 10);</span></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="st">    sigma ~ normal(0, 10);</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="st">    y ~ normal(beta_0 + beta_1 * x, sigma);</span></span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="st">}</span></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="st">"""</span></span>
<span id="cb21-23"><a href="#cb21-23"></a></span>
<span id="cb21-24"><a href="#cb21-24"></a>data_dict <span class="op">=</span> {<span class="st">'N'</span>: n, <span class="st">'x'</span>: x, <span class="st">'y'</span>: y}</span>
<span id="cb21-25"><a href="#cb21-25"></a></span>
<span id="cb21-26"><a href="#cb21-26"></a>posterior <span class="op">=</span> stan.build(model, data<span class="op">=</span>data_dict)</span>
<span id="cb21-27"><a href="#cb21-27"></a>fit <span class="op">=</span> posterior.sample(num_chains<span class="op">=</span><span class="dv">4</span>, num_samples<span class="op">=</span><span class="dv">2500</span>, num_warmup<span class="op">=</span><span class="dv">500</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Building...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Building: found in cache, done.Sampling:   0%
Sampling:  25% (3000/12000)
Sampling:  50% (6000/12000)
Sampling:  75% (9000/12000)
Sampling: 100% (12000/12000)
Sampling: 100% (12000/12000), done.
Messages received during sampling:
  Gradient evaluation took 1.3e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 5e-06 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 1e-05 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
  Adjust your expectations accordingly!
  Gradient evaluation took 6e-06 seconds
  1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
  Adjust your expectations accordingly!</code></pre>
</div>
</div>
<p>El método <code>sampling</code> se utiliza para ajustar el modelo a los datos y realizar inferencias sobre los parámetros del modelo. El método <code>sampling</code> toma como argumento los datos que se utilizarán en el modelo y el número de iteraciones y cadenas que se utilizarán en el algoritmo MCMC.</p>
<div id="2a5aa265" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>df_fit <span class="op">=</span> fit.to_frame()</span>
<span id="cb24-2"><a href="#cb24-2"></a>df_fit.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="538">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">parameters</th>
<th data-quarto-table-cell-role="th">lp__</th>
<th data-quarto-table-cell-role="th">accept_stat__</th>
<th data-quarto-table-cell-role="th">stepsize__</th>
<th data-quarto-table-cell-role="th">treedepth__</th>
<th data-quarto-table-cell-role="th">n_leapfrog__</th>
<th data-quarto-table-cell-role="th">divergent__</th>
<th data-quarto-table-cell-role="th">energy__</th>
<th data-quarto-table-cell-role="th">beta_0</th>
<th data-quarto-table-cell-role="th">beta_1</th>
<th data-quarto-table-cell-role="th">sigma</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">draws</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-425.790441</td>
<td>0.998576</td>
<td>0.318289</td>
<td>3.0</td>
<td>15.0</td>
<td>0.0</td>
<td>426.414575</td>
<td>-5.135882</td>
<td>2.114701</td>
<td>40.687877</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-425.799625</td>
<td>0.950533</td>
<td>0.275060</td>
<td>3.0</td>
<td>11.0</td>
<td>0.0</td>
<td>426.205792</td>
<td>12.608344</td>
<td>1.963094</td>
<td>39.512798</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-425.340789</td>
<td>0.846835</td>
<td>0.275967</td>
<td>4.0</td>
<td>31.0</td>
<td>0.0</td>
<td>426.957590</td>
<td>10.653358</td>
<td>1.958102</td>
<td>37.124869</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-426.128923</td>
<td>0.992620</td>
<td>0.384027</td>
<td>2.0</td>
<td>3.0</td>
<td>0.0</td>
<td>426.135185</td>
<td>16.425698</td>
<td>1.910623</td>
<td>37.761391</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-426.743494</td>
<td>0.878910</td>
<td>0.318289</td>
<td>3.0</td>
<td>7.0</td>
<td>0.0</td>
<td>426.909396</td>
<td>-2.360512</td>
<td>2.134145</td>
<td>41.332574</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Para visualizar los resultados del análisis estadístico bayesiano, se puede convertir el objeto <code>fit</code> en un <code>DataFrame</code> de <code>pandas</code> y visualizar los resultados del análisis estadístico bayesiano. O podemos usar la libreria <code>arviz</code> para visualizar los resultados.</p>
<div id="b7e6d53c" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>az.plot_trace(fit, var_names<span class="op">=</span>[<span class="st">'beta_0'</span>, <span class="st">'beta_1'</span>, <span class="st">'sigma'</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), combined<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-18-output-1.png" width="767" height="800" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Otros gráficos que se pueden hacer son:</p>
<div id="9a87d515" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>az.plot_posterior(fit, var_names<span class="op">=</span>[<span class="st">'beta_0'</span>, <span class="st">'beta_1'</span>, <span class="st">'sigma'</span>], figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), kind<span class="op">=</span><span class="st">'kde'</span>, hdi_prob<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-19-output-1.png" width="916" height="367" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="976f4cc8" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>az.plot_forest(fit, var_names<span class="op">=</span>[<span class="st">'beta_0'</span>, <span class="st">'beta_1'</span>], figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), hdi_prob<span class="op">=</span><span class="fl">0.95</span>, r_hat<span class="op">=</span><span class="va">True</span>, ess <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-20-output-1.png" width="985" height="367" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="e6ded0af" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>az.plot_pair(fit, var_names<span class="op">=</span>[<span class="st">'beta_0'</span>, <span class="st">'beta_1'</span>], figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>), kind<span class="op">=</span><span class="st">'kde'</span>, marginals<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="bayesian_statistics_files/figure-html/cell-21-output-1.png" width="1009" height="688" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Estos gráficos proporcionan información sobre la distribución de probabilidad a posteriori de los parámetros del modelo y permiten realizar inferencias sobre los parámetros del modelo. Por ejemplo, el gráfico de traza muestra la traza de las cadenas de Markov para los parámetros del modelo y permite evaluar la convergencia de las cadenas de Markov. El gráfico de densidad muestra la distribución de probabilidad a posteriori de los parámetros del modelo y permite visualizar la incertidumbre en la estimación de los parámetros del modelo. El gráfico de bosque muestra la distribución de probabilidad a posteriori de los parámetros del modelo y permite comparar los parámetros del modelo entre sí. El gráfico de pares muestra la relación entre los parámetros del modelo y permite visualizar la correlación entre los parámetros del modelo.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Volver arriba</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/christian-f-badillo\.github\.io\/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../statistics/hipothesis_testing.html" class="pagination-link" aria-label="Prueba de Hipótesis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Prueba de Hipótesis</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../neural_neworks/classes_python.html" class="pagination-link" aria-label="Programación Orientada a Objetos en Python">
        <span class="nav-page-text">Programación Orientada a Objetos en Python</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2024 por Christian Francisco Badillo Hernández <br> Contenido con licencia <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales/edit/main/statistics/bayesian_statistics.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Hecho con <a href="https://www.python.org/"><i class="fa-brands fa-python" aria-label="python"></i></a> y <a href="https://quarto.org">Quarto</a> <br> Código fuente disponible en <a href="https://github.com/Christian-F-Badillo/Ciencia-de-datos-con-Python-de-estadistica-descriptiva-a-redes-neuronales">GitHub</a></p>
</div>
  </div>
</footer>




</body></html>